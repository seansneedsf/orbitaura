<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Management - Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        aura: {
                            bg: '#0d0e10',
                            card: '#13141a',
                            border: '#1f2023',
                            accent: '#5e6ad2',
                            purple: '#8b5cf6',
                            text: '#b4bcd0',
                            muted: '#7c8794',
                            darker: '#070707',
                            lighter: '#1a1a1a'
                        }
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        .glass-effect {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .timeline-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #5e6ad2;
            border: 3px solid #0d0e10;
            box-shadow: 0 0 0 1px rgba(94, 106, 210, 0.3);
            position: relative;
            z-index: 10;
        }

        .timeline-dot-active {
            width: 16px;
            height: 16px;
            background: linear-gradient(135deg, #5e6ad2, #8b5cf6);
            border: 3px solid #0d0e10;
            box-shadow: 0 0 0 2px rgba(94, 106, 210, 0.4), 0 0 12px rgba(94, 106, 210, 0.6);
            animation: pulse 2s infinite;
        }

        .timeline-dot-future {
            background: #1f2023;
            border: 3px solid #0d0e10;
            box-shadow: 0 0 0 1px rgba(31, 32, 35, 0.5);
        }

        @keyframes pulse {
            0%,
            100% {
                box-shadow: 0 0 0 2px rgba(94, 106, 210, 0.4), 0 0 12px rgba(94, 106, 210, 0.6);
            }

            50% {
                box-shadow: 0 0 0 4px rgba(94, 106, 210, 0.2), 0 0 20px rgba(94, 106, 210, 0.8);
            }
        }

        .aura-card {
            background: linear-gradient(135deg,
                    rgba(19, 20, 26, 0.9) 0%,
                    rgba(31, 32, 35, 0.5) 100%);
            border: 1px solid rgba(31, 32, 35, 0.8);
        }

        .aura-card-active {
            background: linear-gradient(135deg,
                    rgba(94, 106, 210, 0.1) 0%,
                    rgba(19, 20, 26, 0.95) 30%);
            border: 1px solid rgba(94, 106, 210, 0.3);
        }

        .status-badge {
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .aura-icon {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        .date-label {
            position: absolute;
            left: -60px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 11px;
            font-weight: 500;
            color: #7c8794;
            text-align: right;
            width: 50px;
        }

        .date-label-active {
            color: #5e6ad2;
            font-weight: 600;
        }

        .header-card {
            background: linear-gradient(135deg,
                    rgba(19, 20, 26, 0.95) 0%,
                    rgba(31, 32, 35, 0.8) 100%);
            border: 1px solid rgba(31, 32, 35, 0.8);
        }

        .stat-divider {
            width: 1px;
            background: linear-gradient(180deg, transparent, rgba(94, 106, 210, 0.3) 50%, transparent);
            height: 20px;
        }

        .nav-icon {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(31, 32, 35, 0.8);
            border: 1px solid rgba(94, 106, 210, 0.2);
            transition: all 0.2s ease;
            font-size: 12px;
        }

        .nav-icon:hover {
            background: rgba(94, 106, 210, 0.1);
            border-color: rgba(94, 106, 210, 0.4);
            transform: translateY(-1px);
        }

        /* Project status badge styles */
        .status-badge.status-active {
            background: rgba(94, 106, 210, 0.2);
            color: #5e6ad2;
            border-color: rgba(94, 106, 210, 0.3);
        }

        .status-badge.status-completed {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.3);
        }

        .status-badge.status-archived {
            background: rgba(107, 114, 128, 0.2);
            color: #6b7280;
            border-color: rgba(107, 114, 128, 0.3);
        }

        /* Project card enhancements */
        .project-card {
            transition: all 0.3s ease;
            transform: translateY(-4px);
            border-radius: 12px;
            overflow: hidden;
        }

        .project-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
        }

        .project-card.completed {
            border-left: 3px solid #10b981;
        }

        .project-card.archived {
            opacity: 0.7;
            border-left: 3px solid #6b7280;
        }

        /* Clickable project card enhancements */
        .clickable-project-card {
            transition: all 0.3s ease;
            position: relative;
        }

        .clickable-project-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 16px 32px rgba(0, 0, 0, 0.2);
            border-color: rgba(94, 106, 210, 0.4);
        }

        .clickable-project-card:active {
            transform: translateY(-2px);
            transition: all 0.1s ease;
        }

        .project-hint {
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid rgba(31, 32, 35, 0.5);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .clickable-project-card:hover .project-hint {
            opacity: 1;
        }

        /* Section headers */
        .section-header {
            border-bottom: 2px solid rgba(94, 106, 210, 0.1);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .section-header h2 {
            color: #ffffff;
            font-weight: 600;
        }

        /* Empty state improvements */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #7c8794;
        }

        .empty-state svg {
            margin: 0 auto 1rem;
            opacity: 0.5;
        }

        .empty-state p {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: #b4bcd0;
        }

        .empty-state small {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Overview Cards */
        .overview-card {
            background: linear-gradient(135deg,
                    rgba(19, 20, 26, 0.9) 0%,
                    rgba(31, 32, 35, 0.5) 100%);
            border: 1px solid rgba(31, 32, 35, 0.8);
            border-radius: 12px;
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
        }

        .overview-card:hover {
            border-color: rgba(94, 106, 210, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            padding: 1.25rem 1.5rem 1rem;
            border-bottom: 1px solid rgba(31, 32, 35, 0.8);
        }

        .card-header h2 {
            color: #ffffff;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0;
        }

        .card-content {
            padding: 1.5rem;
        }

        /* Form Cards */
        .form-card {
            background: linear-gradient(135deg,
                    rgba(19, 20, 26, 0.95) 0%,
                    rgba(31, 32, 35, 0.8) 100%);
            border: 1px solid rgba(94, 106, 210, 0.2);
        }

        .form-card-fixed-width {
            width: 100%;
            max-width: 400px;
        }

        /* Project Layout */
        .overview-dashboard {
            display: flex;
            gap: 2rem;
            width: 100%;
        }

        .projects-main-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* Projects Grid */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        /* Project Cards */
        .project-card {
            transition: all 0.3s ease;
            transform: translateY(-4px);
            border-radius: 12px;
            overflow: hidden;
        }

        .project-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
        }

        .project-card.completed {
            border-left: 3px solid #10b981;
        }

        .project-card.archived {
            opacity: 0.7;
            border-left: 3px solid #6b7280;
        }

        .project-header {
            padding: 1rem 1.25rem 0.75rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .project-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .project-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            background: rgba(94, 106, 210, 0.1);
            color: #5e6ad2;
        }

        .project-name {
            font-weight: 600;
            color: #ffffff;
            font-size: 0.95rem;
        }

        .project-content {
            padding: 0 1.25rem 1.25rem;
        }

        .project-description {
            color: #b4bcd0;
            font-size: 0.875rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .project-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .project-stats {
            display: flex;
            gap: 1rem;
            font-size: 0.75rem;
            color: #7c8794;
        }

        .project-stats span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .project-owner-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--project-color, #5e6ad2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .icon-inline {
            width: 12px;
            height: 12px;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.375rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            transition: all 0.2s ease;
            border: 1px solid transparent;
            cursor: pointer;
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.7rem;
        }

        .btn-warning {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
            border-color: rgba(245, 158, 11, 0.2);
        }

        .btn-warning:hover {
            background: rgba(245, 158, 11, 0.2);
            border-color: rgba(245, 158, 11, 0.4);
        }

        .btn-secondary {
            background: rgba(107, 114, 128, 0.1);
            color: #6b7280;
            border-color: rgba(107, 114, 128, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(107, 114, 128, 0.2);
            border-color: rgba(107, 114, 128, 0.4);
        }

        .btn-danger {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.2);
        }

        .btn-danger:hover {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.4);
        }

        .btn-success {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.2);
        }

        .btn-success:hover {
            background: rgba(16, 185, 129, 0.2);
            border-color: rgba(16, 185, 129, 0.4);
        }

        .btn-full {
            width: 100%;
            justify-content: center;
        }

        .btn-lg {
            padding: 0.75rem 1.5rem;
            font-size: 0.875rem;
        }

        .btn-primary {
            background: rgba(94, 106, 210, 0.1);
            color: #5e6ad2;
            border-color: rgba(94, 106, 210, 0.2);
        }

        .btn-primary:hover {
            background: rgba(94, 106, 210, 0.2);
            border-color: rgba(94, 106, 210, 0.4);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            font-weight: 500;
            color: #ffffff;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid rgba(31, 32, 35, 0.8);
            border-radius: 6px;
            background: rgba(31, 32, 35, 0.5);
            color: #ffffff;
            font-size: 0.875rem;
            transition: border-color 0.2s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: rgba(94, 106, 210, 0.4);
            box-shadow: 0 0 0 2px rgba(94, 106, 210, 0.1);
        }

        .form-control::placeholder {
            color: #7c8794;
        }

        /* Flash Messages */
        .flash-messages {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .flash-messages li {
            padding: 0.75rem 1rem;
            border-radius: 6px;
            margin-bottom: 0.5rem;
            border: 1px solid transparent;
        }

        .flash-messages .success {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.2);
        }

        .flash-messages .danger {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.2);
        }

        .flash-messages .warning {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
            border-color: rgba(245, 158, 11, 0.2);
        }

        .flash-messages .info {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border-color: rgba(59, 130, 246, 0.2);
        }

        /* Character counter for form */
        .char-counter {
            font-size: 0.75rem;
            color: #7c8794;
            margin-top: 0.25rem;
        }

        .char-counter.warning {
            color: #f59e0b;
        }

        .char-counter.error {
            color: #ef4444;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .overview-dashboard {
                flex-direction: column;
            }

            .form-card-fixed-width {
                max-width: 100%;
            }

            .projects-grid {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn {
                justify-content: center;
            }
        }

        /* Enhanced Styles for Scalability */
        .view-toggle {
            padding: 0.5rem;
            border-radius: 4px;
            background: transparent;
            color: #7c8794;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .view-toggle.active {
            background: rgba(94, 106, 210, 0.2);
            color: #5e6ad2;
        }

        .view-toggle:hover {
            background: rgba(94, 106, 210, 0.1);
            color: #8b5cf6;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            background: rgba(31, 32, 35, 0.5);
            color: #7c8794;
            border: 1px solid rgba(31, 32, 35, 0.8);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-btn.active {
            background: rgba(94, 106, 210, 0.2);
            color: #5e6ad2;
            border-color: rgba(94, 106, 210, 0.3);
        }

        .filter-btn:hover {
            background: rgba(94, 106, 210, 0.1);
            color: #ffffff;
            border-color: rgba(94, 106, 210, 0.2);
        }

        .project-list-item {
            transition: all 0.2s ease;
        }

        .project-list-item:hover {
            transform: translateY(-1px);
        }

        .project-item.hidden {
            display: none !important;
        }

        /* Better grid responsiveness for many projects */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        @media (min-width: 1400px) {
            .projects-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            }
        }

        @media (max-width: 640px) {
            .projects-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-btn {
                font-size: 0.75rem;
                padding: 0.375rem 0.75rem;
            }
        }
    </style>
</head>

<body class="bg-aura-bg text-aura-text font-inter min-h-screen">

    <div class="flex flex-col md:flex-row h-screen">
        <!-- Mobile header -->
        <header class="md:hidden bg-darker p-4 flex justify-between items-center border-b border-lighter">
            <div class="flex items-center space-x-2">
                <div class="h-6 w-6 rounded-md bg-accent"></div>
                <span class="font-medium">Workspace</span>
            </div>
            <button id="menuToggle" class="text-white">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16">
                    </path>
                </svg>
            </button>
        </header>
        <!-- Sidebar -->
        <div id="sidebar"
            class="hidden md:block w-full md:w-64 header-card flex-shrink-0 flex flex-col h-screen md:h-auto overflow-y-auto">
            <div class="p-4 md:block hidden">
                <div class="flex items-center space-x-2">
                    <div class="h-6 w-6 rounded-md bg-accent"></div>
                    <span class="font-medium">Workspace</span>
                </div>
            </div>

            <nav class="flex-1 py-4">
                <div class="px-3 mb-2 text-xs font-medium text-muted">WORKSPACE</div>
                <a href="{{ url_for('overview_view') }}"
                    class="flex items-center px-3 py-2 text-sm text-white bg-aura-purple rounded-md mx-2">
                    <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                        </path>
                    </svg>
                    Home
                </a>
                <a href="#"
                    class="flex items-center px-3 py-2 text-sm text-muted hover:text-white hover:bg-lighter rounded-md mx-2 mt-1">
                    <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                        </path>
                    </svg>
                    Issues
                </a>
                <a href="#"
                    class="flex items-center px-3 py-2 text-sm text-muted hover:text-white hover:bg-lighter rounded-md mx-2 mt-1">
                    <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                        </path>
                    </svg>
                    Analytics
                </a>
                <a href="#"
                    class="flex items-center px-3 py-2 text-sm text-muted hover:text-white hover:bg-lighter rounded-md mx-2 mt-1">
                    <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Roadmap
                </a>

                <div class="px-3 mt-6 mb-2 text-xs font-medium text-muted">TEAMS</div>
                <a href="#"
                    class="flex items-center px-3 py-2 text-sm text-muted hover:text-white hover:bg-lighter rounded-md mx-2">
                    <div class="w-4 h-4 rounded-sm bg-purple-500 mr-3"></div>
                    Design
                </a>
                <a href="#"
                    class="flex items-center px-3 py-2 text-sm text-muted hover:text-white hover:bg-lighter rounded-md mx-2 mt-1">
                    <div class="w-4 h-4 rounded-sm bg-blue-500 mr-3"></div>
                    Engineering
                </a>
                <a href="#"
                    class="flex items-center px-3 py-2 text-sm text-muted hover:text-white hover:bg-lighter rounded-md mx-2 mt-1">
                    <div class="w-4 h-4 rounded-sm bg-green-500 mr-3"></div>
                    Product
                </a>
            </nav>

            <div class="p-4 border-t border-aura-border">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full bg-accent flex items-center justify-center">
                            <span class="text-sm font-medium">{{ current_user.username[0]|upper if current_user.username else 'U' }}</span>
                        </div>
                        <div class="ml-2">
                            <div class="text-sm font-medium">{{ current_user.username if current_user.username else 'User' }}</div>
                            <div class="text-xs text-muted">My Workspace</div>
                        </div>
                    </div>
                    <div class="relative">
                        <button id="userMenuToggle" class="nav-icon text-aura-text hover:text-white" title="User menu">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                        <div id="userMenu" class="hidden absolute bottom-full right-0 mb-2 w-48 bg-aura-card border border-aura-border rounded-lg shadow-lg">
                            <div class="py-1">
                                <a href="{{ url_for('user_settings') }}" class="flex items-center px-4 py-2 text-sm text-aura-text hover:bg-aura-border hover:text-white">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    </svg>
                                    Settings
                                </a>
                                <div class="border-t border-aura-border"></div>
                                <a href="{{ url_for('logout') }}" class="flex items-center px-4 py-2 text-sm text-red-400 hover:bg-red-500/10 hover:text-red-300">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                    </svg>
                                    Logout
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Main content -->
        <div class="flex-1 flex flex-col overflow-y-auto">

            <!-- Main content area -->

            <div class="max-w-4xl mx-auto p-8">
                <!-- Enhanced Header -->
                <div class="mb-12">
                    <div class="header-card glass-effect rounded-2xl p-8">
                        <!-- Top Row -->
                        <div class="flex items-start justify-between mb-6">
                            <div>
                                <h1 class="text-3xl font-semibold text-white mb-1">Project Management</h1>
                                <p class="text-aura-muted">Organize, track, and manage your projects efficiently</p>
                            </div>

                            <!-- Navigation Icons -->
                            <div class="flex items-center gap-3">
                                <a href="{{ url_for('overview_view') }}" class="nav-icon text-aura-text hover:text-white" title="Home">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                                        </path>
                                    </svg>
                                </a>
                                <a href="{{ url_for('index') }}" class="nav-icon text-aura-text hover:text-white" title="Issues">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                        </path>
                                    </svg>
                                </a>
                                <a href="{{ url_for('calendar_view') }}" class="nav-icon text-aura-text hover:text-white" title="Analytics">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                                        </path>
                                    </svg>
                                </a>
                                <a href="{{ url_for('timeline_view') }}" class="nav-icon text-aura-text hover:text-white" title="Timeline">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
                                        </path>
                                    </svg>
                                </a>
                            </div>
                        </div>

                        <!-- Stats Row -->
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-8">
                                <!-- Project Stats -->
                                <div class="text-center">
                                    <div class="text-2xl font-semibold text-white mb-1">{{ active_projects|length if active_projects else 0 }}</div>
                                    <div class="text-xs text-aura-muted uppercase tracking-wider"
                                        style="font-size: 10px;">Active Projects</div>
                                </div>
                                <div class="stat-divider"></div>

                                <div class="text-center">
                                    <div class="text-2xl font-semibold text-white mb-1">{{ completed_projects|length if completed_projects else 0 }}</div>
                                    <div class="text-xs text-aura-muted uppercase tracking-wider"
                                        style="font-size: 10px;">Completed</div>
                                </div>
                                <div class="stat-divider"></div>

                                <div class="text-center">
                                    <div class="text-2xl font-semibold text-white mb-1">{{ archived_projects|length if archived_projects else 0 }}</div>
                                    <div class="text-xs text-aura-muted uppercase tracking-wider"
                                        style="font-size: 10px;">Archived</div>
                                </div>
                                <div class="stat-divider"></div>

                                <div class="text-center">
                                    {% set total_projects = (active_projects|length if active_projects else 0) + (completed_projects|length if completed_projects else 0) + (archived_projects|length if archived_projects else 0) %}
                                    <div class="text-2xl font-semibold text-aura-accent mb-1">{{ total_projects }}</div>
                                    <div class="text-xs text-aura-muted uppercase tracking-wider"
                                        style="font-size: 10px;">Total Projects</div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="flex items-center gap-3 mt-6 pt-6 border-t border-aura-border">
                            <span class="text-xs text-aura-muted">Quick Actions:</span>
                            <button onclick="document.getElementById('projectForm').scrollIntoView({behavior: 'smooth'})"
                                class="text-xs px-3 py-1.5 rounded-md bg-aura-accent/10 text-aura-accent border border-aura-accent/20 hover:bg-aura-accent/20 transition-colors">
                                <i class="fas fa-plus mr-1"></i> Add Project
                            </button>
                            <a href="{{ url_for('overview_view') }}"
                                class="text-xs px-3 py-1.5 rounded-md bg-aura-border text-aura-text hover:bg-aura-card transition-colors">
                                <i class="fas fa-home mr-1"></i> Dashboard
                            </a>
                            <a href="{{ url_for('timeline_view') }}"
                                class="text-xs px-3 py-1.5 rounded-md bg-aura-border text-aura-text hover:bg-aura-card transition-colors">
                                <i class="fas fa-clock mr-1"></i> Timeline
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Timeline Container -->
                <div class="relative ml-16 flex">
                    <!-- Timeline Items -->
                    {% if user_projects %}
                    <div class="space-y-8">
                        <!-- Active Projects Section -->
                        {% set active_projects = [] %}
                        {% set completed_projects = [] %}
                        {% set archived_projects_timeline = [] %}
                        
                        {% for project in user_projects %}
                            {% if project.archived %}
                                {% set _ = archived_projects_timeline.append(project) %}
                            {% else %}
                                {% set total_tasks = project.tasks|length %}
                                {% if total_tasks == 0 %}
                                    {% set _ = active_projects.append(project) %}
                                {% else %}
                                    {% set done_tasks = project.tasks|selectattr('status', 'equalto', 'Done')|list|length %}
                                    {% if done_tasks == total_tasks %}
                                        {% set _ = completed_projects.append(project) %}
                                    {% else %}
                                        {% set _ = active_projects.append(project) %}
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        
                        <!-- Sort projects by start_date or created_at -->
                        {% set active_projects = active_projects|sort(attribute='start_date')|reverse if active_projects else [] %}
                        {% set completed_projects = completed_projects|sort(attribute='end_date')|reverse if completed_projects else [] %}
                        {% set archived_projects_timeline = archived_projects_timeline|sort(attribute='updated_at')|reverse if archived_projects_timeline else [] %}
                        
                        <!-- Active Projects -->
                        {% for project in active_projects %}
                        <div class="relative flex items-start gap-6">
                            <div class="relative">
                                <div class="date-label date-label-active">
                                    {% if project.start_date %}
                                        {{ project.start_date.strftime('%b %d') }}
                                    {% else %}
                                        {{ project.created_at.strftime('%b %d') }}
                                    {% endif %}
                                </div>
                                <div class="timeline-dot-active timeline-dot"></div>
                            </div>
                            <div class="aura-card-active aura-card glass-effect rounded-xl p-6 flex-1 max-w-2xl">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="flex items-center gap-3">
                                        <div class="aura-icon bg-aura-accent/20 text-aura-accent">
                                            <i class="fas fa-rocket"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-white font-medium">{{ project.name }}</h3>
                                            <p class="text-xs text-aura-muted mt-1">{{ project.owner_user.username }}</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="status-badge px-2 py-1 rounded-md bg-aura-accent/20 text-aura-accent border border-aura-accent/30">
                                            Active
                                        </span>
                                    </div>
                                </div>

                                <p class="text-sm text-aura-text mb-4 leading-relaxed">
                                    {{ project.description if project.description else 'No description available.' }}
                                </p>

                                <div class="flex items-center justify-between">
                                    <div class="flex gap-2">
                                        {% if project.end_date %}
                                        <span class="text-xs px-2 py-1 rounded-md bg-aura-border text-aura-muted">
                                            Due {{ project.end_date.strftime('%b %d') }}
                                        </span>
                                        {% endif %}
                                        <span class="text-xs px-2 py-1 rounded-md bg-aura-border text-aura-muted">
                                            In Progress
                                        </span>
                                    </div>

                                    <div class="flex items-center gap-4 text-xs text-aura-muted">
                                        {% set p_tasks = project.tasks if project.tasks is not none else [] %}
                                        {% set total_tasks = p_tasks | length %}
                                        <span><i class="fas fa-tasks mr-1"></i> {{ total_tasks }} tasks</span>
                                        {% if total_tasks > 0 %}
                                        {% set done_tasks_count = (p_tasks | selectattr('status', 'equalto', 'Done') | list | length) %}
                                        <span><i class="fas fa-percentage mr-1"></i> {{ done_tasks_count }} / {{ total_tasks }} complete</span>
                                        {% else %}
                                        <span><i class="fas fa-percentage mr-1"></i> 0 / 0 complete</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}

                        <!-- Completed Projects -->
                        {% for project in completed_projects %}
                        <div class="relative flex items-start gap-6">
                            <div class="relative">
                                <div class="date-label">
                                    {% if project.end_date %}
                                        {{ project.end_date.strftime('%b %d') }}
                                    {% else %}
                                        {{ project.updated_at.strftime('%b %d') }}
                                    {% endif %}
                                </div>
                                <div class="timeline-dot"></div>
                            </div>
                            <div class="aura-card glass-effect rounded-xl p-6 flex-1 max-w-2xl">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="flex items-center gap-3">
                                        <div class="aura-icon bg-green-500/20 text-green-400">
                                            <i class="fas fa-check"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-white font-medium">{{ project.name }}</h3>
                                            <p class="text-xs text-aura-muted mt-1">{{ project.owner_user.username }}</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="status-badge px-2 py-1 rounded-md bg-green-500/20 text-green-400 border border-green-500/30">
                                            Completed
                                        </span>
                                    </div>
                                </div>

                                <p class="text-sm text-aura-text mb-4 leading-relaxed">
                                    {{ project.description if project.description else 'No description available.' }}
                                </p>

                                <div class="border-t border-aura-border pt-3 mt-4">
                                    <div class="flex items-center justify-between text-xs text-aura-muted">
                                        <div class="flex gap-4">
                                            {% set p_tasks = project.tasks if project.tasks is not none else [] %}
                                            {% set total_tasks = p_tasks | length %}
                                            <span><i class="fas fa-tasks mr-1"></i> {{ total_tasks }} tasks completed</span>
                                            {% if project.start_date and project.end_date %}
                                            {% set duration = (project.end_date - project.start_date).days %}
                                            <span><i class="fas fa-calendar mr-1"></i> {{ duration }} days</span>
                                            {% endif %}
                                        </div>
                                        {% if project.end_date %}
                                        <span><i class="fas fa-calendar-check mr-1"></i> Completed {{ project.end_date.strftime('%b %d') }}</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}

                        <!-- Archived Projects -->
                        {% for project in archived_projects_timeline %}
                        <div class="relative flex items-start gap-6">
                            <div class="relative">
                                <div class="date-label">{{ project.updated_at.strftime('%b %d') }}</div>
                                <div class="timeline-dot-future timeline-dot"></div>
                            </div>
                            <div class="aura-card glass-effect rounded-xl p-6 flex-1 max-w-2xl opacity-60">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="flex items-center gap-3">
                                        <div class="aura-icon bg-aura-border text-aura-muted">
                                            <i class="fas fa-archive"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-white font-medium">{{ project.name }}</h3>
                                            <p class="text-xs text-aura-muted mt-1">{{ project.owner_user.username }}</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="status-badge px-2 py-1 rounded-md bg-aura-border text-aura-muted border border-aura-border">
                                            Archived
                                        </span>
                                    </div>
                                </div>

                                <p class="text-sm text-aura-text mb-4 leading-relaxed">
                                    {{ project.description if project.description else 'No description available.' }}
                                </p>

                                <div class="flex items-center justify-between text-xs text-aura-muted">
                                    {% set p_tasks = project.tasks if project.tasks is not none else [] %}
                                    {% set total_tasks = p_tasks | length %}
                                    <span><i class="fas fa-tasks mr-1"></i> {{ total_tasks }} tasks</span>
                                    <span><i class="fas fa-archive mr-1"></i> Archived {{ project.updated_at.strftime('%b %d') }}</span>
                                </div>
                            </div>
                        </div>
                        {% endfor %}

                        <!-- Static Future Items (if no real projects to show) -->
                        {% if not active_projects and not completed_projects and not archived_projects_timeline %}
                        <!-- Future Item -->
                        <div class="relative flex items-start gap-6">
                            <div class="relative">
                                <div class="date-label">Jan 22</div>
                                <div class="timeline-dot-future timeline-dot"></div>
                            </div>
                            <div class="aura-card glass-effect rounded-xl p-6 flex-1 max-w-2xl opacity-60">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="flex items-center gap-3">
                                        <div class="aura-icon bg-aura-border text-aura-muted">
                                            <i class="fas fa-mobile-alt"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-white font-medium">Create Your First Project</h3>
                                            <p class="text-xs text-aura-muted mt-1">Get started with project management</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="status-badge px-2 py-1 rounded-md bg-aura-border text-aura-muted border border-aura-border">
                                            Planned
                                        </span>
                                    </div>
                                </div>

                                <p class="text-sm text-aura-text mb-4 leading-relaxed">
                                    Start organizing your work by creating your first project using the form below.
                                </p>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    {% else %}
                    <!-- Empty state when no projects exist -->
                    <div class="space-y-8">
                        <div class="relative flex items-start gap-6">
                            <div class="relative">
                                <div class="date-label">Today</div>
                                <div class="timeline-dot-future timeline-dot"></div>
                            </div>
                            <div class="aura-card glass-effect rounded-xl p-6 flex-1 max-w-2xl opacity-60">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="flex items-center gap-3">
                                        <div class="aura-icon bg-aura-border text-aura-muted">
                                            <i class="fas fa-plus"></i>
                                        </div>
                                        <div>
                                            <h3 class="text-white font-medium">Create Your First Project</h3>
                                            <p class="text-xs text-aura-muted mt-1">Get started with project management</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="status-badge px-2 py-1 rounded-md bg-aura-border text-aura-muted border border-aura-border">
                                            Ready
                                        </span>
                                    </div>
                                </div>

                                <p class="text-sm text-aura-text mb-4 leading-relaxed">
                                    Start organizing your work by creating your first project using the form below.
                                </p>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Project Management Section -->
            <div class="max-w-7xl mx-auto p-8 w-full">
                <div class="overview-dashboard">
                    <!-- Add Project Form Card -->
                    <div class="overview-card form-card form-card-fixed-width">
                        <div class="card-header">
                            <h2>
                                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="10" />
                                    <path d="M12 8v8m4-4H8" />
                                </svg>
                                Add New Project
                            </h2>
                        </div>
                        <div class="card-content">
                            <form method="POST" action="{{ url_for('manage_projects') }}" id="projectForm">
                                <div class="form-group">
                                    <label for="name">Project Name</label>
                                    <input type="text" id="name" name="name" class="form-control"
                                        placeholder="Enter project name" required>
                                </div>
                                <div class="form-group">
                                    <label for="description">Description</label>
                                    <textarea id="description" name="description" class="form-control"
                                        placeholder="Describe your project goals and objectives (optional)"
                                        rows="3"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="start_date">Start Date</label>
                                    <input type="date" id="start_date" name="start_date" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label for="end_date">End Date</label>
                                    <input type="date" id="end_date" name="end_date" class="form-control">
                                </div>
                                <button type="submit" class="btn btn-primary btn-full btn-lg">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                        <path d="M12 2v20m8-10H4" />
                                    </svg>
                                    Create Project
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="projects-main-column">
                        <!-- Enhanced Projects Header with Search and Filters -->
                        <div class="overview-card">
                            <div class="card-header">
                                <div class="flex items-center justify-between w-full">
                                    <h2>
                                        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                            <path d="M3 7h5l2 3h11v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7z" />
                                        </svg>
                                        All Projects
                                    </h2>
                                    <div class="flex items-center gap-2">
                                        <!-- View Toggle -->
                                        <div class="flex items-center bg-aura-border rounded-lg p-1">
                                            <button id="gridViewBtn" class="view-toggle active" data-view="grid" title="Grid View">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                    <rect x="3" y="3" width="7" height="7"></rect>
                                                    <rect x="14" y="3" width="7" height="7"></rect>
                                                    <rect x="14" y="14" width="7" height="7"></rect>
                                                    <rect x="3" y="14" width="7" height="7"></rect>
                                                </svg>
                                            </button>
                                            <button id="listViewBtn" class="view-toggle" data-view="list" title="List View">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                    <line x1="8" y1="6" x2="21" y2="6"></line>
                                                    <line x1="8" y1="12" x2="21" y2="12"></line>
                                                    <line x1="8" y1="18" x2="21" y2="18"></line>
                                                    <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                                    <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                                    <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                                </svg>
                                            </button>
                                        </div>
                                        
                                        <!-- Sort Dropdown -->
                                        <div class="relative">
                                            <button id="sortBtn" class="nav-icon text-aura-text hover:text-white" title="Sort Options">
                                                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                    <path d="M3 6h18M7 12h10m-7 6h4"></path>
                                                </svg>
                                            </button>
                                            <div id="sortMenu" class="hidden absolute right-0 top-full mt-2 w-48 bg-aura-card border border-aura-border rounded-lg shadow-lg z-10">
                                                <div class="py-1">
                                                    <button class="sort-option flex items-center w-full px-4 py-2 text-sm text-aura-text hover:bg-aura-border hover:text-white" data-sort="name">
                                                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" class="mr-2">
                                                            <path d="M14 9V5a3 3 0 0 0-6 0v4M3 9h18l-1 11H4L3 9z"></path>
                                                        </svg>
                                                        Sort by Name
                                                    </button>
                                                    <button class="sort-option flex items-center w-full px-4 py-2 text-sm text-aura-text hover:bg-aura-border hover:text-white" data-sort="date">
                                                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" class="mr-2">
                                                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                                            <line x1="16" y1="2" x2="16" y2="6"></line>
                                                            <line x1="8" y1="2" x2="8" y2="6"></line>
                                                            <line x1="3" y1="10" x2="21" y2="10"></line>
                                                        </svg>
                                                        Sort by Date
                                                    </button>
                                                    <button class="sort-option flex items-center w-full px-4 py-2 text-sm text-aura-text hover:bg-aura-border hover:text-white" data-sort="tasks">
                                                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" class="mr-2">
                                                            <path d="M9 11l3 3 8-8"></path>
                                                            <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c1.51 0 2.93.37 4.18 1.03"></path>
                                                        </svg>
                                                        Sort by Progress
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            <div class="card-content">
                                <!-- Search and Filter Bar -->
                                <div class="mb-6 space-y-4">
                                    <!-- Search Bar -->
                                    <div class="relative">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" class="text-aura-muted">
                                                <circle cx="11" cy="11" r="8"></circle>
                                                <path d="M21 21l-4.35-4.35"></path>
                                            </svg>
                                        </div>
                                        <input type="text" id="projectSearch" placeholder="Search projects..." class="form-control pl-10">
                                    </div>
                                    
                                    <!-- Filter Buttons -->
                                    <div class="flex flex-wrap gap-2">
                                        <button class="filter-btn active" data-filter="all">
                                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                <path d="M3 7h5l2 3h11v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7z"></path>
                                            </svg>
                                            All Projects
                                        </button>
                                        <button class="filter-btn" data-filter="active">
                                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <polyline points="12,6 12,12 16,14"></polyline>
                                            </svg>
                                            Active
                                        </button>
                                        <button class="filter-btn" data-filter="completed">
                                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                <path d="M20 6L9 17l-5-5"></path>
                                            </svg>
                                            Completed
                                        </button>
                                        <button class="filter-btn" data-filter="archived">
                                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                <polyline points="21,8 21,21 3,21 3,8"></polyline>
                                                <rect x="1" y="3" width="22" height="5"></rect>
                                                <line x1="10" y1="12" x2="14" y2="12" />
                                            </svg>
                                            Archived
                                        </button>
                                    </div>
                                </div>

                                {% set project_colors = ['#6366f1', '#f59e42', '#10b981', '#f43f5e', '#3b82f6', '#a21caf', '#fbbf24', '#14b8a6'] %}
                                {% if user_projects %}
                                <!-- Project Counter -->
                                <div class="mb-4">
                                    <span id="projectCounter" class="text-sm text-aura-muted">Showing <span id="visibleCount">{{ user_projects|length }}</span> of {{ user_projects|length }} projects</span>
                                </div>

                                <!-- Projects Container -->
                                <div id="projectsContainer">
                                    <!-- Grid View -->
                                    <div id="gridView" class="projects-grid">
                                        {% for project in user_projects %}
                                        {% set color = project_colors[loop.index0 % project_colors|length] %}
                                        {% set total_tasks = project.tasks|length if project.tasks else 0 %}
                                        {% set done_tasks = project.tasks|selectattr('status', 'equalto', 'Done')|list|length if project.tasks else 0 %}
                                        {% set is_completed = total_tasks > 0 and done_tasks == total_tasks %}
                                        
                                        <div class="project-item aura-card project-card clickable-project-card {% if project.archived %}archived{% elif is_completed %}completed{% endif %}" 
                                             data-project-url="{{ url_for('view_tasks', project_id=project.id) }}"
                                             data-name="{{ project.name|lower }}"
                                             data-status="{% if project.archived %}archived{% elif is_completed %}completed{% else %}active{% endif %}"
                                             data-tasks="{{ total_tasks }}"
                                             data-date="{{ project.created_at.timestamp() }}"
                                             style="cursor: pointer;">
                                            <div class="project-header">
                                                <div class="project-info">
                                                    <div class="project-icon">
                                                        {% if project.archived %}
                                                        <svg width="16" height="16" fill="none" stroke="currentColor"
                                                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                            viewBox="0 0 24 24">
                                                            <polyline points="21,8 21,21 3,21 3,8" />
                                                            <rect x="1" y="3" width="22" height="5" />
                                                            <line x1="10" y1="12" x2="14" y2="12" />
                                                        </svg>
                                                        {% elif is_completed %}
                                                        <svg width="16" height="16" fill="none" stroke="currentColor"
                                                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                            viewBox="0 0 24 24">
                                                            <path d="M20 6L9 17l-5-5" />
                                                        </svg>
                                                        {% else %}
                                                        <svg width="16" height="16" fill="none" stroke="currentColor"
                                                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                            viewBox="0 0 24 24">
                                                            <path d="M3 7h5l2 3h11v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7z" />
                                                        </svg>
                                                        {% endif %}
                                                    </div>
                                                    <span class="project-name">{{ project.name }}</span>
                                                </div>
                                                {% if project.archived %}
                                                <span class="status-badge px-2 py-1 rounded-md bg-aura-border text-aura-muted border border-aura-border">Archived</span>
                                                {% elif is_completed %}
                                                <span class="status-badge px-2 py-1 rounded-md bg-green-500/20 text-green-400 border border-green-500/30">Completed</span>
                                                {% else %}
                                                <span class="status-badge px-2 py-1 rounded-md bg-aura-accent/20 text-aura-accent border border-aura-accent/30">Active</span>
                                                {% endif %}
                                            </div>
                                            <div class="project-content">
                                                <p class="project-description">{{ project.description if project.description else 'No description available.' }}</p>
                                                <div class="project-footer">
                                                    <div class="project-stats">
                                                        <span>
                                                            <svg width="14" height="14" fill="none" stroke="currentColor"
                                                                stroke-width="2" stroke-linecap="round"
                                                                stroke-linejoin="round" viewBox="0 0 24 24"
                                                                class="icon-inline">
                                                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                                                            </svg>
                                                            {{ total_tasks }} tasks
                                                        </span>
                                                        {% if total_tasks > 0 %}
                                                        <span>
                                                            <svg width="14" height="14" fill="none" stroke="currentColor"
                                                                stroke-width="2" stroke-linecap="round"
                                                                stroke-linejoin="round" viewBox="0 0 24 24"
                                                                class="icon-inline">
                                                                <path d="M20 6L9 17l-5-5" />
                                                            </svg>
                                                            {{ done_tasks }}/{{ total_tasks }} done
                                                        </span>
                                                        {% endif %}
                                                        {% if project.end_date %}
                                                        <span>
                                                            <svg width="14" height="14" fill="none" stroke="currentColor"
                                                                stroke-width="2" stroke-linecap="round"
                                                                stroke-linejoin="round" viewBox="0 0 24 24"
                                                                class="icon-inline">
                                                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                                                                <line x1="16" y1="2" x2="16" y2="6" />
                                                                <line x1="8" y1="2" x2="8" y2="6" />
                                                                <line x1="3" y1="10" x2="21" y2="10" />
                                                            </svg>
                                                            Due {{ project.end_date.strftime('%b %d') }}
                                                        </span>
                                                        {% endif %}
                                                    </div>
                                                    <span title="Project owner" class="project-owner-avatar"
                                                        style="--project-color: {{ color }};">{{
                                                        project.owner_user.username[0]|upper }}</span>
                                                </div>
                                                
                                                <div class="project-hint">
                                                    <small class="text-aura-muted">
                                                        <svg width="12" height="12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" class="inline mr-1">
                                                            <path d="M9 18l6-6-6-6"/>
                                                        </svg>
                                                        Click to view project details
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                    
                                    <!-- List View -->
                                    <div id="listView" class="hidden space-y-3">
                                        {% for project in user_projects %}
                                        {% set color = project_colors[loop.index0 % project_colors|length] %}
                                        {% set total_tasks = project.tasks|length if project.tasks else 0 %}
                                        {% set done_tasks = project.tasks|selectattr('status', 'equalto', 'Done')|list|length if project.tasks else 0 %}
                                        {% set is_completed = total_tasks > 0 and done_tasks == total_tasks %}
                                        
                                        <div class="project-item project-list-item {% if project.archived %}archived{% elif is_completed %}completed{% else %}active{% endif %}"
                                             data-project-url="{{ url_for('view_tasks', project_id=project.id) }}"
                                             data-name="{{ project.name|lower }}"
                                             data-status="{% if project.archived %}archived{% elif is_completed %}completed{% else %}active{% endif %}"
                                             data-tasks="{{ total_tasks }}"
                                             data-date="{{ project.created_at.timestamp() }}"
                                             onclick="window.location.href='{{ url_for('view_tasks', project_id=project.id) }}'"
                                             style="cursor: pointer;">
                                            <div class="flex items-center justify-between p-4 bg-aura-card border border-aura-border rounded-lg hover:border-aura-accent/30 transition-all">
                                                <div class="flex items-center gap-4 flex-1">
                                                    <div class="project-icon">
                                                        {% if project.archived %}
                                                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                            <polyline points="21,8 21,21 3,21 3,8" />
                                                            <rect x="1" y="3" width="22" height="5" />
                                                            <line x1="10" y1="12" x2="14" y2="12" />
                                                        </svg>
                                                        {% elif is_completed %}
                                                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                            <path d="M20 6L9 17l-5-5" />
                                                        </svg>
                                                        {% else %}
                                                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                                            <path d="M3 7h5l2 3h11v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7z" />
                                                        </svg>
                                                        {% endif %}
                                                    </div>
                                                    <div class="flex-1 min-w-0">
                                                        <h3 class="project-name text-white font-medium truncate">{{ project.name }}</h3>
                                                        <p class="text-sm text-aura-muted truncate">{{ project.description if project.description else 'No description available.' }}</p>
                                                    </div>
                                                </div>
                                                <div class="flex items-center gap-6">
                                                    <div class="text-right">
                                                        <div class="text-sm text-aura-text">{{ total_tasks }} tasks</div>
                                                        {% if total_tasks > 0 %}
                                                        <div class="text-xs text-aura-muted">{{ done_tasks }}/{{ total_tasks }} done</div>
                                                        {% endif %}
                                                    </div>
                                                    <div class="flex items-center gap-2">
                                                        {% if project.archived %}
                                                        <span class="status-badge px-2 py-1 rounded-md bg-aura-border text-aura-muted border border-aura-border">Archived</span>
                                                        {% elif is_completed %}
                                                        <span class="status-badge px-2 py-1 rounded-md bg-green-500/20 text-green-400 border border-green-500/30">Completed</span>
                                                        {% else %}
                                                        <span class="status-badge px-2 py-1 rounded-md bg-aura-accent/20 text-aura-accent border border-aura-accent/30">Active</span>
                                                        {% endif %}
                                                        <span title="Project owner" class="project-owner-avatar" style="--project-color: {{ color }};">{{ project.owner_user.username[0]|upper }}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>

                                <!-- No Results Message -->
                                <div id="noResults" class="hidden empty-state">
                                    <svg width="48" height="48" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="M21 21l-4.35-4.35"></path>
                                    </svg>
                                    <p>No projects found</p>
                                    <small>Try adjusting your search or filter criteria</small>
                                </div>
                                {% else %}
                                <div class="empty-state">
                                    <svg width="48" height="48" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                        <path d="M3 7h5l2 3h11v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7z" />
                                    </svg>
                                    <p>No projects yet</p>
                                    <small>Create your first project using the form on the left</small>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <ul class="flash-messages fixed bottom-4 right-4 z-50 space-y-2">
                {% for category, message in messages %}
                <li
                    class="{{ category }} p-3 rounded-md shadow-lg bg-aura-card text-sm text-aura-text border border-aura-border">
                    {{ message }}
                </li>
                {% endfor %}
            </ul>
            {% endif %}
            {% endwith %}
        </div>

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                // Form validation and enhancement
                const projectForm = document.getElementById('projectForm');
                const startDateInput = document.getElementById('start_date');
                const endDateInput = document.getElementById('end_date');
                const nameInput = document.getElementById('name');

                // Set minimum date to today for date inputs
                const today = new Date().toISOString().split('T')[0];
                if (startDateInput) startDateInput.setAttribute('min', today);
                if (endDateInput) endDateInput.setAttribute('min', today);

                // Auto-adjust end date when start date changes
                if (startDateInput && endDateInput) {
                    startDateInput.addEventListener('change', function () {
                        if (this.value) {
                            endDateInput.setAttribute('min', this.value);
                            if (endDateInput.value && endDateInput.value < this.value) {
                                endDateInput.value = '';
                            }
                        }
                    });
                }

                // Form submission enhancement
                if (projectForm) {
                    projectForm.addEventListener('submit', function (e) {
                        const submitBtn = this.querySelector('button[type="submit"]');
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = `
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" class="animate-spin">
                            <path d="M21 12a9 9 0 11-6.219-8.56"/>
                        </svg>
                        Creating...
                    `;

                        // Re-enable button after 3 seconds to prevent permanent lock
                        setTimeout(() => {
                            if (submitBtn.disabled) { // Only revert if it's still in the "Creating..." state
                                submitBtn.disabled = false;
                                submitBtn.innerHTML = `
                                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                    <path d="M12 2v20m8-10H4"/>
                                </svg>
                                Create Project
                            `;
                            }
                        }, 3000);
                    });
                }

                // Auto-hide flash messages
                const flashMessages = document.querySelectorAll('.flash-messages li');
                flashMessages.forEach(function (message) {
                    setTimeout(function () {
                        message.style.opacity = '0';
                        message.style.transform = 'translateX(100%)';
                        setTimeout(function () {
                            message.remove();
                        }, 300);
                    }, 5000);
                });

                // Enhanced project cards interaction
                const projectCards = document.querySelectorAll('.clickable-project-card');
                projectCards.forEach(function (card) {
                    card.addEventListener('mouseenter', function () {
                        this.style.transform = 'translateY(-6px)';
                    });

                    card.addEventListener('mouseleave', function () {
                        this.style.transform = 'translateY(-4px)';
                    });
                    
                    // Handle card click navigation
                    card.addEventListener('click', function() {
                        const projectUrl = this.getAttribute('data-project-url');
                        if (projectUrl) {
                            window.location.href = projectUrl;
                        }
                    });
                    
                    // Prevent click when clicking on action buttons (if any exist)
                    const actionButtons = card.querySelectorAll('button, a');
                    actionButtons.forEach(function(button) {
                        button.addEventListener('click', function(e) {
                            e.stopPropagation();
                        });
                    });
                });

                // Character counter for description
                const descriptionTextarea = document.getElementById('description');
                if (descriptionTextarea) {
                    const maxLength = 500;
                    const counterDiv = document.createElement('div');
                    counterDiv.classList.add('char-counter');
                    descriptionTextarea.parentNode.appendChild(counterDiv);

                    function updateCounter() {
                        const remaining = maxLength - descriptionTextarea.value.length;
                        counterDiv.textContent = `${remaining} characters remaining`;
                        counterDiv.classList.remove('warning', 'error');
                        if (remaining < 50) {
                            counterDiv.classList.add('error');
                        } else if (remaining < 100) {
                            counterDiv.classList.add('warning');
                        }
                    }

                    descriptionTextarea.setAttribute('maxlength', maxLength);
                    descriptionTextarea.addEventListener('input', updateCounter);
                    updateCounter();
                }

                // Mobile menu toggle
                const menuToggle = document.getElementById('menuToggle');
                if (menuToggle) {
                    menuToggle.addEventListener('click', function () {
                        const sidebar = document.getElementById('sidebar');
                        sidebar.classList.toggle('hidden');
                    });
                }

                // User menu dropdown toggle
                const userMenuToggle = document.getElementById('userMenuToggle');
                const userMenu = document.getElementById('userMenu');
                if (userMenuToggle && userMenu) {
                    userMenuToggle.addEventListener('click', function(e) {
                        e.stopPropagation();
                        userMenu.classList.toggle('hidden');
                    });

                    // Close dropdown when clicking outside
                    document.addEventListener('click', function(e) {
                        if (!userMenuToggle.contains(e.target) && !userMenu.contains(e.target)) {
                            userMenu.classList.add('hidden');
                        }
                    });

                    // Close dropdown when pressing Escape
                    document.addEventListener('keydown', function(e) {
                        if (e.key === 'Escape') {
                            userMenu.classList.add('hidden');
                        }
                    });
                }

                // Project search and filter functionality
                const projectSearch = document.getElementById('projectSearch');
                const filterButtons = document.querySelectorAll('.filter-btn');
                const projectItems = document.querySelectorAll('.project-item');
                const visibleCount = document.getElementById('visibleCount');
                const noResults = document.getElementById('noResults');
                const gridView = document.getElementById('gridView');
                const listView = document.getElementById('listView');
                const gridViewBtn = document.getElementById('gridViewBtn');
                const listViewBtn = document.getElementById('listViewBtn');
                const sortBtn = document.getElementById('sortBtn');
                const sortMenu = document.getElementById('sortMenu');

                let currentFilter = 'all';
                let currentSort = 'name';
                let currentView = 'grid';

                // Search functionality
                if (projectSearch) {
                    projectSearch.addEventListener('input', function() {
                        filterAndSearch();
                    });
                }

                // Filter functionality
                filterButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        filterButtons.forEach(btn => btn.classList.remove('active'));
                        this.classList.add('active');
                        currentFilter = this.dataset.filter;
                        filterAndSearch();
                    });
                });

                // View toggle functionality
                if (gridViewBtn && listViewBtn) {
                    gridViewBtn.addEventListener('click', function() {
                        if (currentView !== 'grid') {
                            currentView = 'grid';
                            gridViewBtn.classList.add('active');
                            listViewBtn.classList.remove('active');
                            gridView.classList.remove('hidden');
                            listView.classList.add('hidden');
                        }
                    });

                    listViewBtn.addEventListener('click', function() {
                        if (currentView !== 'list') {
                            currentView = 'list';
                            listViewBtn.classList.add('active');
                            gridViewBtn.classList.remove('active');
                            listView.classList.remove('hidden');
                            gridView.classList.add('hidden');
                        }
                    });
                }

                // Sort functionality
                if (sortBtn && sortMenu) {
                    sortBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        sortMenu.classList.toggle('hidden');
                    });

                    const sortOptions = document.querySelectorAll('.sort-option');
                    sortOptions.forEach(option => {
                        option.addEventListener('click', function() {
                            currentSort = this.dataset.sort;
                            sortMenu.classList.add('hidden');
                            sortProjects();
                        });
                    });

                    document.addEventListener('click', function(e) {
                        if (!sortBtn.contains(e.target) && !sortMenu.contains(e.target)) {
                            sortMenu.classList.add('hidden');
                        }
                    });
                }

                function filterAndSearch() {
                    const searchTerm = projectSearch ? projectSearch.value.toLowerCase() : '';
                    let visibleProjects = 0;

                    // Get project items from current view
                    const currentItems = currentView === 'grid' 
                        ? document.querySelectorAll('#gridView .project-item')
                        : document.querySelectorAll('#listView .project-item');

                    currentItems.forEach(item => {
                        const name = item.dataset.name || '';
                        const status = item.dataset.status || '';
                        
                        const matchesSearch = name.includes(searchTerm);
                        const matchesFilter = currentFilter === 'all' || status === currentFilter;
                        
                        if (matchesSearch && matchesFilter) {
                            item.classList.remove('hidden');
                            visibleProjects++;
                        } else {
                            item.classList.add('hidden');
                        }
                    });

                    // Update counter
                    if (visibleCount) {
                        visibleCount.textContent = visibleProjects;
                    }

                    // Show/hide no results message
                    if (noResults) {
                        if (visibleProjects === 0 && (searchTerm || currentFilter !== 'all')) {
                            noResults.classList.remove('hidden');
                        } else {
                            noResults.classList.add('hidden');
                        }
                    }
                }

                function sortProjects() {
                    const gridItems = Array.from(document.querySelectorAll('#gridView .project-item'));
                    const listItems = Array.from(document.querySelectorAll('#listView .project-item'));
                    
                    [gridItems, listItems].forEach((items, index) => {
                        const container = index === 0 ? gridView : listView;
                        
                        items.sort((a, b) => {
                            switch (currentSort) {
                                case 'name':
                                    return a.dataset.name.localeCompare(b.dataset.name);
                                case 'date':
                                    return parseFloat(b.dataset.date) - parseFloat(a.dataset.date);
                                case 'tasks':
                                    return parseInt(b.dataset.tasks) - parseInt(a.dataset.tasks);
                                default:
                                    return 0;
                            }
                        });

                        // Re-append sorted items
                        items.forEach(item => container.appendChild(item));
                    });

                    // Re-apply current filters after sorting
                    filterAndSearch();
                }

                // Initialize with default sort
                sortProjects();
            });
        </script>
        <script>
            document.getElementById('menuToggle').addEventListener('click', function () {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.toggle('hidden');
            });
        </script>
</body>

</html>